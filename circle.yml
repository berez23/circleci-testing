machine:
  node:
    version: 5.1.0
    
dependencies:
  pre:
    - echo "None, for now"
    
test:
  override:
    # Only update the config if the tar file exists (which means the cache was reset)
    - |
      if [[ ! -e elasticsearch-5.6.3 ]]; then
        wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.6.3.tar.gz && tar -xvf elasticsearch-5.6.3.tar.gz
        echo script.inline: true >> elasticsearch-5.6.3/config/elasticsearch.yml
      fi
    - elasticsearch-5.6.3/bin/elasticsearch: { background: true }
    - sleep 10 && curl --retry 10 --retry-delay 5 -v http://127.0.0.1:9200/
